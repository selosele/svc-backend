<?xml version="1.0" encoding="utf-8" ?>

<SmartSqlMap Scope="EmployeeRepository" xmlns="http://SmartSql.net/schemas/SmartSqlMap.xsd">
  <ResultMaps>
    <ResultMap Id="EmployeeResultMap">
      <Result Column="EMPLOYEE_ID" Property="EmployeeId" />
      <Result Column="EMPLOYEE_NAME" Property="EmployeeName" />
      <Result Column="GENDER_CODE" Property="GenderCode" />
      <Result Column="BIRTH_YMD" Property="BirthYmd" />
      <Result Column="PHONE_NUMBER" Property="PhoneNumber" />
    </ResultMap>
  </ResultMaps>

  <Statements>

    <!-- 직원을 조회한다. -->
    <Statement Id="GetEmployee" ResultMap="EmployeeResultMap">
      /* EmployeeRepository.GetEmployee */

      SELECT
        E.EMPLOYEE_ID,
        E.EMPLOYEE_NAME,
        E.GENDER_CODE,
        E.BIRTH_YMD,
        E.PHONE_NUMBER
      FROM HM_EMPLOYEE E
      INNER JOIN CO_USER U ON U.USER_ID = E.USER_ID AND U.DELETE_YN = 'N'
      WHERE 1=1
        <IsNotEmpty Property="UserId">
        AND U.USER_ID = @UserId
        </IsNotEmpty>
        <IsNotEmpty Property="EmployeeId">
        AND E.EMPLOYEE_ID = @EmployeeId
        </IsNotEmpty>
    </Statement>

    <!-- 직원을 수정한다. -->
    <Statement Id="UpdateEmployee">
      /* EmployeeRepository.UpdateEmployee */

      UPDATE HM_EMPLOYEE
        SET
          <IsNotEmpty Property="EmployeeCompany.CompanyId">
          COMPANY_ID = @EmployeeCompany.CompanyId,
          </IsNotEmpty>
          <IsNotEmpty Property="EmployeeName">
          EMPLOYEE_NAME = @EmployeeName,
          </IsNotEmpty>
          <IsNotEmpty Property="GenderCode">
          GENDER_CODE = @GenderCode,
          </IsNotEmpty>
          <IsNotEmpty Property="BirthYmd">
          BIRTH_YMD = @BirthYmd,
          </IsNotEmpty>
          <IsNotEmpty Property="PhoneNumber">
          PHONE_NUMBER = @PhoneNumber,
          </IsNotEmpty>
          UPDATER_ID = @UpdaterId,
          UPDATE_DT = CURRENT_TIMESTAMP()
      WHERE EMPLOYEE_ID = @EmployeeId
    </Statement>
    
  </Statements>
</SmartSqlMap>