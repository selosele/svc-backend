<?xml version="1.0" encoding="utf-8" ?>

<SmartSqlMap Scope="VacationRepository" xmlns="http://SmartSql.net/schemas/SmartSqlMap.xsd">
  <ResultMaps>
    <ResultMap Id="VacationResultMap">
      <Result Column="VACATION_ID" Property="VacationId" />
      <Result Column="EMPLOYEE_ID" Property="EmployeeId" />
      <Result Column="EMPLOYEE_COMPANY_ID" Property="EmployeeCompanyId" />
      <Result Column="VACATION_TYPE_CODE" Property="VacationTypeCode" />
      <Result Column="VACATION_CONTENT" Property="VacationContent" />
      <Result Column="VACATION_START_YMD" Property="VacationStartYmd" />
      <Result Column="VACATION_END_YMD" Property="VacationEndYmd" />
      <Result Column="DELETE_YN" Property="DeleteYn" />
    </ResultMap>
  </ResultMaps>

  <Statements>

    <!-- 휴가 목록을 조회한다. -->
    <Statement Id="ListVacation" ResultMap="VacationResultMap">
      /* VacationRepository.ListVacation */

      SELECT
        V.VACATION_ID,
        V.EMPLOYEE_ID,
        V.EMPLOYEE_COMPANY_ID,
        V.VACATION_TYPE_CODE,
        V.VACATION_CONTENT,
        V.VACATION_START_YMD,
        V.VACATION_END_YMD,
        V.DELETE_YN
      FROM HM_VACATION V
      WHERE V.DELETE_YN = 'N'
        AND V.EMPLOYEE_COMPANY_ID = @EmployeeCompanyId
      ORDER BY V.VACATION_START_YMD DESC
    </Statement>

    <!-- 휴가를 조회한다. -->
    <Statement Id="GetVacation" ResultMap="VacationResultMap">
      /* VacationRepository.GetVacation */

      SELECT
        V.VACATION_ID,
        V.EMPLOYEE_ID,
        V.EMPLOYEE_COMPANY_ID,
        V.VACATION_TYPE_CODE,
        V.VACATION_CONTENT,
        V.VACATION_START_YMD,
        V.VACATION_END_YMD,
        V.DELETE_YN
      FROM HM_VACATION V
      WHERE V.DELETE_YN = 'N'
        AND V.VACATION_ID = @VacationId
    </Statement>

    <!-- 휴가를 삭제한다. -->
    <Statement Id="RemoveVacation">
      /* VacationRepository.RemoveVacation */

      UPDATE HM_VACATION
        SET
          DELETE_YN = 'Y',
          UPDATER_ID = @UpdaterId,
          UPDATE_DT = CURRENT_TIMESTAMP()
      WHERE VACATION_ID = @VacationId
    </Statement>
    
  </Statements>
</SmartSqlMap>