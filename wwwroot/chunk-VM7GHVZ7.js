import{a as ye}from"./chunk-DMOL23QP.js";import{b as fe}from"./chunk-RNF5X5JX.js";import{H as Ce,f as B,h as re,i as T,l as ne,m as le,n as se,o as c,p as ae,q as ue,u as me,w as de,x as ce,y as pe}from"./chunk-JJVA2OUS.js";import{$b as J,A as f,Ac as X,B as _,Ea as E,Ec as Z,F as A,Fc as ee,Ka as $,L as n,M as h,Ma as P,Pb as G,U as F,Vc as te,W as C,Wb as N,Y as l,Yb as Y,_b as K,ab as O,ba as y,bb as z,ca as R,da as L,ea as j,fa as a,ga as u,gd as ie,ha as m,jd as oe,kb as Q,la as g,ma as v,na as d,ra as H,sa as q,ta as M,uc as k,va as b,w as U,wc as W,xa as I,z as V}from"./chunk-D4IPV4YQ.js";import"./chunk-M6OTSRMF.js";import"./chunk-FK6H3RFT.js";import{a as D,b as w,f as x}from"./chunk-USDYGGWM.js";function be(t,s){if(t&1&&(a(0,"p",2),b(1),$(2,"date"),u()),t&2){let o=d();n(),I("\uB9C8\uC9C0\uB9C9 \uB85C\uADF8\uC778 \uC77C\uC2DC: ",P(2,1,o.detailForm.get("lastLoginDt").value,"yyyy\uB144 MM\uC6D4 dd\uC77C hh\uC2DC mm\uBD84 ss\uCD08"),"")}}function De(t,s){if(t&1&&(a(0,"div",4),m(1,"ui-text-field",20),u()),t&2){let o=d();n(),l("control",o.detailForm.get("userId"))("label","\uC0AC\uC6A9\uC790 ID")("readonly",!0)}}function xe(t,s){if(t&1&&(a(0,"div",4),m(1,"ui-text-field",22),u()),t&2){let o=d();n(),l("control",o.detailForm.get("userPassword"))("label","\uC0AC\uC6A9\uC790 \uBE44\uBC00\uBC88\uD638")("placeholder","12\uC790 \uC774\uB0B4")}}function ge(t,s){if(t&1){let o=g();a(0,"div",7)(1,"ui-button",23),v("click",function(i){f(o);let e=d();return _(e.updateUserActiveYn(i,(e.detail==null?null:e.detail.userActiveYn)==="Y"?"N":"Y"))}),b(2),u()()}if(t&2){let o=d();n(),l("severity","secondary"),n(),I(" ",(o.detail==null?null:o.detail.userActiveYn)==="Y"?"\uC7A0\uAE08\uC124\uC815":"\uC7A0\uAE08\uD574\uC81C"," ")}}function we(t,s){if(t&1&&m(0,"ui-checkbox",10),t&2){let o=s.$implicit,r=d();l("control",r.detailForm.get("roles"))("label",o.roleName)("value",o.roleId)}}function Ue(t,s){if(t&1&&m(0,"ui-text-field",20),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.corporateName"))("label","\uD68C\uC0AC(\uBC95\uC778)\uBA85")("readonly",!0)}}function Ae(t,s){if(t&1&&m(0,"ui-company-field",17),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.corporateName"))("label","\uD68C\uC0AC(\uBC95\uC778)\uBA85")}}function Fe(t,s){if(t&1&&m(0,"ui-text-field",20),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.companyName"))("label","\uD68C\uC0AC\uBA85")("readonly",!0)}}function Ee(t,s){if(t&1&&m(0,"ui-company-field",17),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.companyName"))("label","\uD68C\uC0AC\uBA85")}}function ke(t,s){if(t&1&&m(0,"ui-text-field",20),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.joinYmd"))("label","\uC785\uC0AC\uC77C\uC790")("readonly",!0)}}function Be(t,s){if(t&1&&m(0,"ui-date-field",16),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.joinYmd"))("label","\uC785\uC0AC\uC77C\uC790")("dateFormat","yymmdd")("placeholder","YYYYMMDD")}}function Te(t,s){if(t&1&&m(0,"ui-text-field",20),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.quitYmd"))("label","\uD1F4\uC0AC\uC77C\uC790")("readonly",!0)}}function Ie(t,s){if(t&1&&m(0,"ui-date-field",16),t&2){let o=d();l("control",o.detailForm.get("employee.workHistory.quitYmd"))("label","\uD1F4\uC0AC\uC77C\uC790")("dateFormat","yymmdd")("placeholder","YYYYMMDD")}}function Ne(t,s){if(t&1){let o=g();a(0,"ui-button",24),v("click",function(){f(o);let i=d();return _(i.superLogin())}),b(1," \uB85C\uADF8\uC778 "),u()}t&2&&l("size","small")}var _e=(()=>{let s=class s extends B{constructor(r,i,e,p,S,he){super(),this.fb=r,this.route=i,this.roleStore=e,this.messageService=p,this.userService=S,this.codeService=he,this.detail=null,this.ynCodes=this.codeService.createYnCodeData(),this.defaultUserActiveYn="Y",this.roles=[],this.defaultRoles=[],this.useRemove=!0,this.isUserSelf=!1,this.refresh=new A,this.remove=new A,this.close=new A}get isDetailNotEmpty(){return J(this.detail)}ngOnInit(){this.route.data.subscribe(({code:r})=>{this.genderCodes=r.GENDER_00,this.rankCodes=r.RANK_00,this.jobTitleCodes=r.JOB_TITLE_00}),this.detailForm=this.fb.group({userId:[""],userAccount:["",[c.required,c.minLength(3),c.maxLength(20)]],userPassword:["",[c.required]],userActiveYn:["",[c.required]],lastLoginDt:[""],roles:["",[c.required]],employee:this.fb.group({employeeId:[""],employeeName:["",[c.required,c.maxLength(30)]],genderCode:["",[c.required]],birthYmd:[""],phoneNo:[""],emailAddr:["",[c.email]],workHistory:this.fb.group({workHistoryId:[""],companyId:[""],corporateName:["",[c.required]],companyName:["",[c.required]],joinYmd:["",[c.required]],quitYmd:[""],rankCode:["",[c.required]],jobTitleCode:["",[c.required]]})})})}ngOnChanges(r){if(r.detail&&this.detailForm){if(this.isUserSelf=Number(this.user?.userId)===this.detail.userId,this.useRemove=!this.isUserSelf,this.roles=this.roleStore.select("roleList").value,this.defaultRoles=this.roles.filter(i=>i.roleId===G.EMPLOYEE.id).map(i=>i.roleId),K(r.detail.currentValue)){this.useRemove=!1,this.detailForm.reset({userActiveYn:this.defaultUserActiveYn,roles:this.defaultRoles,employee:{workHistory:{jobTitleCode:"0098"}}}),this.detailForm.get("userPassword").setValidators([c.required,c.maxLength(12)]),this.detailForm.get("userPassword").updateValueAndValidity();return}this.detailForm.get("userPassword").clearValidators(),this.detailForm.get("userPassword").patchValue(null),this.detailForm.get("userPassword").updateValueAndValidity(),this.detailForm.patchValue(w(D({},this.detail),{roles:this.detail?.roles?.map(i=>i.roleId)||this.defaultRoles,employee:w(D({},this.detail?.employee),{workHistory:this.detail?.employee?.workHistoryList[0]})}))}}updateUserActiveYn(r,i){return x(this,null,function*(){(yield this.messageService.confirm1(`\uACC4\uC815\uC744 ${i==="Y"?"\uC7A0\uAE08\uD574\uC81C\uD558\uC2DC\uACA0\uC5B4\uC694?":"\uC7A0\uADF8\uC2DC\uACA0\uC5B4\uC694?"}`))&&this.userService.updateUser$({userId:this.detail?.userId,userActiveYn:i}).subscribe(p=>{this.messageService.toastSuccess("\uC815\uC0C1\uC801\uC73C\uB85C \uCC98\uB9AC\uB418\uC5C8\uC5B4\uC694."),this.detail=p.user,this.detailForm.patchValue(w(D(D({},this.detailForm.value),this.detail),{roles:this.detail?.roles?.map(S=>S.roleId)})),this.refresh.emit()})})}onSubmit(r){return x(this,null,function*(){let i=N(r.userId)?"\uB4F1\uB85D":"\uC218\uC815";(yield this.messageService.confirm1(`\uC0AC\uC6A9\uC790 \uBC0F \uC9C1\uC6D0 \uC815\uBCF4\uB97C ${i}\uD558\uC2DC\uACA0\uC5B4\uC694?`))&&(N(r.userId)?this.userService.addUser$(r).subscribe(p=>{this.messageService.toastSuccess(`\uC815\uC0C1\uC801\uC73C\uB85C ${i}\uB418\uC5C8\uC5B4\uC694.`),this.detailForm.get("userId").patchValue(p.user.userId),this.refresh.emit()}):this.userService.updateUser$(r).subscribe(p=>{this.messageService.toastSuccess(`\uC815\uC0C1\uC801\uC73C\uB85C ${i}\uB418\uC5C8\uC5B4\uC694.`),this.refresh.emit()}))})}onRemove(r){return x(this,null,function*(){(yield this.messageService.confirm2("\uC0AC\uC6A9\uC790\uB97C \uC0AD\uC81C\uD558\uC2DC\uACA0\uC5B4\uC694?<br>\uC774 \uC791\uC5C5\uC740 \uBCF5\uAD6C\uD560 \uC218 \uC5C6\uC5B4\uC694."))&&this.userService.removeUser$(this.detail.userId).subscribe(()=>{this.messageService.toastSuccess("\uC815\uC0C1\uC801\uC73C\uB85C \uC0AD\uC81C\uB418\uC5C8\uC5B4\uC694."),this.remove.emit()})})}superLogin(){return x(this,null,function*(){(yield this.messageService.confirm1(`${this.detail.userAccount}(${this.detail.employee.employeeName}\uB2D8) \uACC4\uC815\uC73C\uB85C \uB85C\uADF8\uC778\uD558\uC2DC\uACA0\uC5B4\uC694?`))&&this.authService.superLogin({userAccount:this.detail.userAccount})})}onClose(){this.close.emit()}};s.\u0275fac=function(i){return new(i||s)(h(te),h(Q),h(ye),h(oe),h(T),h(fe))},s.\u0275cmp=U({type:s,selectors:[["system-user-detail"]],inputs:{detail:"detail"},outputs:{refresh:"refresh",remove:"remove",close:"close"},standalone:!0,features:[F,V,E],decls:48,vars:45,consts:[[3,"submit","remove","close","form","useRemove"],[3,"text"],[1,"mt-2"],[1,"grid","mt-2","mb-4"],[1,"col"],[3,"control","label","readonly","placeholder"],[3,"control","label","data","readonly"],[1,"col","flex","align-items-end"],[1,"col-12"],[3,"label"],[3,"control","label","value"],[1,"grid","mt-2"],[1,"col-3"],[3,"control","label","placeholder"],[3,"control","label","data"],[1,"col-4"],[3,"control","label","dateFormat","placeholder"],[3,"control","label"],[1,"col-6"],[3,"control"],[3,"control","label","readonly"],["button","",3,"size"],["type","password",3,"control","label","placeholder"],["button","",3,"click","severity"],["button","",3,"click","size"]],template:function(i,e){i&1&&(a(0,"ui-split-form",0),v("submit",function(S){return e.onSubmit(S)})("remove",function(S){return e.onRemove(S)})("close",function(){return e.onClose()}),m(1,"ui-content-title",1),C(2,be,3,4,"p",2),a(3,"div",3),C(4,De,2,3,"div",4),a(5,"div",4),m(6,"ui-text-field",5),u(),C(7,xe,2,3,"div",4),a(8,"div",4),m(9,"ui-dropdown",6),u(),C(10,ge,3,2,"div",7),a(11,"div",8)(12,"ui-checkbox-group",9)(13,"ui-card")(14,"ui-checkbox-list"),L(15,we,1,3,"ui-checkbox",10,R),u()()()()(),m(17,"ui-content-title",1),a(18,"div",11)(19,"div",12),m(20,"ui-text-field",13),u(),a(21,"div",12),m(22,"ui-dropdown",14),u(),a(23,"div",12),m(24,"ui-dropdown",14),u(),a(25,"div",12),m(26,"ui-dropdown",14),u(),a(27,"div",15),m(28,"ui-date-field",16),u(),a(29,"div",15),m(30,"ui-text-field",13),u(),a(31,"div",15),m(32,"ui-text-field",17),u(),a(33,"div",18),m(34,"ui-hidden-field",19)(35,"ui-hidden-field",19),C(36,Ue,1,3,"ui-text-field",20)(37,Ae,1,2,"ui-company-field",17),u(),a(38,"div",18),C(39,Fe,1,3,"ui-text-field",20)(40,Ee,1,2,"ui-company-field",17),u(),a(41,"div",18),C(42,ke,1,3,"ui-text-field",20)(43,Be,1,4,"ui-date-field",16),u(),a(44,"div",18),C(45,Te,1,3,"ui-text-field",20)(46,Ie,1,4,"ui-date-field",16),u()(),C(47,Ne,2,1,"ui-button",21),u()),i&2&&(l("form",e.detailForm)("useRemove",e.useRemove),n(),l("text","\uC0AC\uC6A9\uC790 \uC815\uBCF4"),n(),y(e.isDetailNotEmpty?2:-1),n(2),y(e.isDetailNotEmpty?4:-1),n(2),l("control",e.detailForm.get("userAccount"))("label","\uC0AC\uC6A9\uC790 \uACC4\uC815")("readonly",e.isDetailNotEmpty)("placeholder","20\uC790 \uC774\uB0B4"),n(),y(e.isDetailNotEmpty?-1:7),n(2),l("control",e.detailForm.get("userActiveYn"))("label","\uC0AC\uC6A9\uC790 \uACC4\uC815 \uD65C\uC131\uD654")("data",e.ynCodes)("readonly",e.isDetailNotEmpty),n(),y(e.isDetailNotEmpty&&!e.isUserSelf?10:-1),n(2),l("label","\uC0AC\uC6A9\uC790 \uAD8C\uD55C"),n(3),j(e.roles),n(2),l("text","\uC9C1\uC6D0 \uC815\uBCF4"),n(3),l("control",e.detailForm.get("employee.employeeName"))("label","\uC9C1\uC6D0\uBA85")("placeholder","30\uC790 \uC774\uB0B4"),n(2),l("control",e.detailForm.get("employee.genderCode"))("label","\uC131\uBCC4")("data",e.genderCodes),n(2),l("control",e.detailForm.get("employee.workHistory.rankCode"))("label","\uC9C1\uC704")("data",e.rankCodes),n(2),l("control",e.detailForm.get("employee.workHistory.jobTitleCode"))("label","\uC9C1\uCC45")("data",e.jobTitleCodes),n(2),l("control",e.detailForm.get("employee.birthYmd"))("label","\uC0DD\uB144\uC6D4\uC77C")("dateFormat","yymmdd")("placeholder","YYYYMMDD"),n(2),l("control",e.detailForm.get("employee.phoneNo"))("label","\uD734\uB300\uD3F0\uBC88\uD638")("placeholder","- \uC81C\uC678"),n(2),l("control",e.detailForm.get("employee.emailAddr"))("label","\uC774\uBA54\uC77C\uC8FC\uC18C"),n(2),l("control",e.detailForm.get("employee.workHistory.workHistoryId")),n(),l("control",e.detailForm.get("employee.workHistory.companyId")),n(),y(e.isDetailNotEmpty?36:37),n(3),y(e.isDetailNotEmpty?39:40),n(3),y(e.isDetailNotEmpty?42:43),n(3),y(e.isDetailNotEmpty?45:46),n(2),y(e.isDetailNotEmpty&&!e.isUserSelf?47:-1))},dependencies:[z,O,ae,ne,de,pe,ce,se,le,me,k,ue,X,W]});let t=s;return t})();var Ye=["splitter"];function Ve(t,s){t&1&&m(0,"ui-skeleton")(1,"ui-skeleton")(2,"ui-skeleton")}function Re(t,s){if(t&1){let o=g();a(0,"ui-splitter",null,0)(2,"ui-table",2,1),v("refresh",function(){f(o);let i=d();return _(i.onRefresh())})("rowSelect",function(i){f(o);let e=d();return _(e.onRowSelect(i))})("unRowSelect",function(i){f(o);let e=d();return _(e.onRowUnselect(i))}),a(4,"ui-button",3),v("click",function(){f(o);let i=d();return _(i.addUser())}),u()(),a(5,"div",4)(6,"system-user-detail",5),v("refresh",function(){f(o);let i=d();return _(i.listUser())})("remove",function(){f(o);let i=d();return _(i.onRemove())})("close",function(){f(o);let i=d();return _(i.onClose())}),u()()()}if(t&2){let o=d();n(2),l("useAdd",!1)("useRemove",!1)("cols",o.cols)("data",o.userList)("dataKey","userId")("selection",o.selection),n(2),l("size","small")("icon","pi-plus")("label","\uC0AC\uC6A9\uC790 \uB4F1\uB85D")("outlined",!0),n(2),l("detail",o.detail)}}var st=(()=>{let s=class s extends B{constructor(r,i){super(),this.userStore=r,this.userService=i,this.detail=null,this.cols=[{field:"userAccount",header:"\uC0AC\uC6A9\uC790 \uACC4\uC815"},{field:"employeeName",header:"\uC9C1\uC6D0\uBA85"},{field:"companyName",header:"\uD68C\uC0AC\uBA85"},{header:"\uC9C1\uC704/\uC9C1\uCC45",valueGetter:e=>e.jobTitleCode==="ETC"?e.rankCodeName:Y(e.rankCodeName)&&Y(e.jobTitleCodeName)?"":`${e.rankCodeName}/${e.jobTitleCodeName}`},{field:"userActiveYn",header:"\uC0AC\uC6A9\uC790 \uD65C\uC131\uD654 \uC5EC\uBD80"},{field:"rolesString",header:"\uAD8C\uD55C"}]}get userList(){return this.userStore.select("userList").value}get userListDataLoad(){return this.userStore.select("userListDataLoad").value}ngOnInit(){!this.userListDataLoad&&this.user&&this.listUser()}listUser(){this.userService.listUser()}addUser(){this.detail={},this.splitter.show()}onRowSelect(r){this.userService.getUser$(r.data.userId).subscribe(i=>{this.detail=i.user,this.splitter.show()})}onRowUnselect(r){this.detail={},this.splitter.hide()}onRefresh(){this.listUser()}onRemove(){this.splitter.hide(),this.listUser()}onClose(){this.splitter.hide()}};s.\u0275fac=function(i){return new(i||s)(h(re),h(T))},s.\u0275cmp=U({type:s,selectors:[["view-system-user"]],viewQuery:function(i,e){if(i&1&&H(Ye,5),i&2){let p;q(p=M())&&(e.splitter=p.first)}},standalone:!0,features:[F,E],decls:8,vars:1,consts:[["splitter",""],["table",""],["first","",3,"refresh","rowSelect","unRowSelect","useAdd","useRemove","cols","data","dataKey","selection"],["buttons","",3,"click","size","icon","label","outlined"],["second",""],[3,"refresh","remove","close","detail"]],template:function(i,e){i&1&&(a(0,"layout-page-description")(1,"ul")(2,"li"),b(3,"\uC0AC\uC6A9\uC790\uB97C \uC870\uD68C/\uC785\uB825\uD560 \uC218 \uC788\uC5B4\uC694."),u(),a(4,"li"),b(5,"\uC0AC\uC6A9\uC790\uC5D0\uAC8C \uAD8C\uD55C\uC744 \uBD80\uC5EC/\uD68C\uC218\uD560 \uC218 \uC788\uC5B4\uC694."),u()()(),C(6,Ve,3,0)(7,Re,7,11,"ui-splitter")),i&2&&(n(6),y(e.userListDataLoad?7:6))},dependencies:[k,Z,ie,ee,Ce,_e]});let t=s;return t})();export{st as SystemUserComponent};
