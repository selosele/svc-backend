import{a as q,b as xe,c as Ie}from"./chunk-GZI5C7JE.js";import{H as we,f as V,k as ge,l as be,o as S,q as Ae,x as Se,y as ye}from"./chunk-6O6EEPEW.js";import{A as p,B as f,Ea as k,Ec as he,F as X,Fa as Y,I as J,L as c,M as d,Pb as Q,U as I,Vc as Ce,W as A,Wb as j,Wc as _e,Xb as P,Y as s,Za as oe,_b as O,a as te,ba as g,bb as ae,c as w,cc as me,dc as ue,eb as le,fa as a,fc as pe,ga as l,gd as ve,ha as C,ic as E,j as ie,jb as ce,jc as z,jd as H,kb as se,la as _,lc as fe,ma as u,mb as de,n as re,na as m,r as U,u as $,uc as N,va as b,w as x,wa as M,xa as ne}from"./chunk-SI4ONGGJ.js";import{a as L,b as B,f as W}from"./chunk-USDYGGWM.js";var y=class extends Ie{};w([q(({value:r})=>P(r)?Number(r):null)],y.prototype,"articleId",void 0);w([q(({value:r})=>P(r)?Number(r):null)],y.prototype,"boardId",void 0);w([q(({value:r})=>P(r)?Number(r):null)],y.prototype,"articleWriterId",void 0);var G=(()=>{let i=class i extends me{constructor(){super()}init(){this.creates([{key:"articleResponse",defaultValue:null},{key:"mainArticleResponse",defaultValue:null},{key:"noticeList",defaultValue:[]},{key:"noticeListDataLoad",defaultValue:!1}])}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var D=(()=>{let i=class i{constructor(e,t,o){this.http=e,this.httpService=t,this.articleStore=o}listArticle$(e){let t=this.httpService.createParams(e);return this.http.get("/co/articles",{params:t})}listArticle(e){this.listArticle$({boardId:e}).subscribe(t=>{let o=this.articleStore.select("articleResponse").value;this.articleStore.update("articleResponse",B(L({},o),{[e]:{data:t,dataLoad:!0}}))})}listMainArticle(e,t){this.listArticle$({boardId:e,limit:t}).subscribe(o=>{let h=this.articleStore.select("mainArticleResponse").value;this.articleStore.update("mainArticleResponse",B(L({},h),{[e]:{data:o,dataLoad:!0}}))})}getArticle$(e){return this.http.get(`/co/articles/${e}`)}addArticle$(e){return this.http.post("/co/articles",e)}updateArticle$(e){let{articleId:t}=e;return this.http.put(`/co/articles/${t}`,e)}removeArticle$(e){return this.http.delete(`/co/articles/${e}`)}getArticleTitle(e,t){return e.articleWriterId===t?`<span class="mr-2 px-2 py-1 bg-primary-50 text-primary">\uB0B4\uAC00\uC4F4\uAE00</span> ${e.articleTitle}`:e.articleTitle}getArticleWriterName(e,t={tagUseYn:"Y"}){return e.isSystemAdmin===1?t.tagUseYn==="Y"?e.articleWriterNickname??`<strong>${Q.SYSTEM_ADMIN.name}</strong>`:e.articleWriterNickname??Q.SYSTEM_ADMIN.name:e.articleWriterNickname??e.employeeName}};i.\u0275fac=function(t){return new(t||i)($(le),$(pe),$(G))},i.\u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"});let r=i;return r})();var Te=()=>({display:"flex"});function Re(r,i){if(r&1){let n=_();a(0,"ui-button",11),u("click",function(){p(n);let t=m();return f(t.goToArticle())}),b(1," \uB4A4\uB85C\uAC00\uAE30 "),l()}r&2&&s("text",!0)}var T=class T extends V{constructor(i,n,e,t,o){super(),this.fb=i,this.config=n,this.dialogRef=e,this.messageService=t,this.articleService=o,this.detail=null,this.useRemove=!0,this.isNicknameEditable=!0,this.refresh=new X,this.remove=new X}get action(){return this.config.data.action}get article(){return this.config.data.article}ngOnInit(){this.detailForm=this.fb.group({articleId:[""],boardId:[this.config.data.boardId],articleTitle:["",[S.required,S.maxLength(100)]],articleContent:["",[S.required]],articleWriterId:[""],articleWriterNickname:["",[S.required,S.maxLength(30)]],useNicknameYn:[["Y"]]}),this.action===this.actions.UPDATE&&(this.detailForm.patchValue(B(L({},this.article),{useNicknameYn:this.article.articleWriterNickname?["Y"]:[],articleWriterNickname:this.articleService.getArticleWriterName(this.article,{tagUseYn:"N"})})),this.detailForm.get("useNicknameYn").disable(),this.detailForm.get("articleWriterNickname").disable())}onSubmit(i){return W(this,null,function*(){let n=j(i.articleId)?"\uC791\uC131":"\uC218\uC815";(yield this.messageService.confirm1(`\uAC8C\uC2DC\uAE00\uC744 ${n}\uD558\uC2DC\uACA0\uC5B4\uC694?`))&&(j(i.articleId)?this.articleService.addArticle$(i).subscribe(t=>{this.messageService.toastSuccess(`\uC815\uC0C1\uC801\uC73C\uB85C ${n}\uB418\uC5C8\uC5B4\uC694.`),this.dialogRef.close({action:this.actions.SAVE})}):this.articleService.updateArticle$(i).subscribe(t=>{this.messageService.toastSuccess(`\uC815\uC0C1\uC801\uC73C\uB85C ${n}\uB418\uC5C8\uC5B4\uC694.`),this.dialogRef.close({action:this.actions.SAVE})}))})}onUseNicknameYnChange(i){i.checked[0]==="Y"?(this.isNicknameEditable=!0,this.detailForm.get("articleWriterNickname").patchValue(""),this.detailForm.get("articleWriterNickname").enable(),this.detailForm.get("articleWriterNickname").setValidators([S.required,S.maxLength(30)])):(this.isNicknameEditable=!1,this.detailForm.get("articleWriterNickname").patchValue(this.user?.employeeName),this.detailForm.get("articleWriterNickname").disable(),this.detailForm.get("articleWriterNickname").clearValidators()),this.detailForm.get("articleWriterNickname").updateValueAndValidity()}goToArticle(){let i=this.detailForm.get("articleId").value;this.dialogRef.close({action:this.actions.RELOAD,data:{articleId:i}})}};T.\u0275fac=function(n){return new(n||T)(d(Ce),d(E),d(z),d(H),d(D))},T.\u0275cmp=x({type:T,selectors:[["modal-save-article"]],inputs:{detail:"detail"},outputs:{refresh:"refresh",remove:"remove"},standalone:!0,features:[I,k],decls:14,vars:22,consts:[[3,"submit","form"],[3,"control"],[1,"grid","mt-2"],[1,"col-12"],[1,"grid","align-items-center"],[1,"col","sm:col-fixed"],[3,"control","label","placeholder","tooltip","tooltipPosition","readonly"],["button","",3,"change","control","label","value","ngStyle"],[3,"control","label","placeholder"],[3,"control","label","placeholder","height"],["button","",3,"text"],["button","",3,"click","text"]],template:function(n,e){n&1&&(a(0,"ui-form",0),u("submit",function(o){return e.onSubmit(o)}),C(1,"ui-hidden-field",1)(2,"ui-hidden-field",1),a(3,"div",2)(4,"div",3)(5,"div",4)(6,"div",5)(7,"ui-text-field",6)(8,"ui-checkbox",7),u("change",function(o){return e.onUseNicknameYnChange(o)}),l()()()()(),a(9,"div",3),C(10,"ui-text-field",8),l(),a(11,"div",3),C(12,"ui-editor",9),l()(),A(13,Re,2,1,"ui-button",10),l()),n&2&&(s("form",e.detailForm),c(),s("control",e.detailForm.get("articleId")),c(),s("control",e.detailForm.get("boardId")),c(5),s("control",e.detailForm.get("articleWriterNickname"))("label","\uB2C9\uB124\uC784")("placeholder","\uB2C9\uB124\uC784")("tooltip",e.isNicknameEditable?"\uAC8C\uC2DC\uAE00 \uC791\uC131 \uD6C4 \uB2C9\uB124\uC784\uC740 \uBCC0\uACBD\uD560 \uC218 \uC5C6\uC5B4\uC694.":"")("tooltipPosition","bottom")("readonly",!e.isNicknameEditable),c(),s("control",e.detailForm.get("useNicknameYn"))("label","\uB2C9\uB124\uC784 \uC0AC\uC6A9")("value","Y")("ngStyle",Y(21,Te)),c(2),s("control",e.detailForm.get("articleTitle"))("label","\uC81C\uBAA9")("placeholder","\uC81C\uBAA9\uC744 \uC785\uB825\uD558\uC138\uC694."),c(2),s("control",e.detailForm.get("articleContent"))("label","\uB0B4\uC6A9")("placeholder","\uB0B4\uC6A9\uC744 \uC785\uB825\uD558\uC138\uC694.")("height","200px"),c(),g(e.action===e.actions.UPDATE?13:-1))},dependencies:[ae,oe,_e,ge,Ae,be,Se,ye,N]});var R=T;w([xe(y)],R.prototype,"onSubmit",null);function Fe(r,i){if(r&1){let n=_();a(0,"ui-button",12),u("click",function(){p(n);let t=m();return f(t.goPrevNextArticle(t.prevArticle==null?null:t.prevArticle.articleId))}),l(),a(1,"ui-button",12),u("click",function(){p(n);let t=m();return f(t.goPrevNextArticle(t.nextArticle==null?null:t.nextArticle.articleId))}),l()}if(r&2){let n=m();s("icon","pi-chevron-left")("rounded",!0)("text",!0)("severity","primary")("disabled",n.prevArticle==null)("title","\uC774\uC804 \uAC8C\uC2DC\uAE00"),c(),s("icon","pi-chevron-right")("rounded",!0)("text",!0)("severity","primary")("disabled",n.nextArticle==null)("title","\uB2E4\uC74C \uAC8C\uC2DC\uAE00")}}function Le(r,i){if(r&1){let n=_();a(0,"ui-button",13),u("click",function(){p(n);let t=m();return f(t.updateArticle(t.article))}),b(1," \uC218\uC815 "),l()}r&2&&s("size","small")("severity","primary")}function Be(r,i){if(r&1){let n=_();a(0,"ui-button",13),u("click",function(){p(n);let t=m();return f(t.removeArticle(t.article.articleId))}),b(1," \uC0AD\uC81C "),l()}r&2&&s("size","small")("severity","danger")}var Ne=(()=>{let i=class i extends V{constructor(e,t,o,h){super(),this.config=e,this.dialogRef=t,this.messageService=o,this.articleService=h}get board(){return this.config.data.board}get article(){return this.config.data.article}get articleList(){return this.config.data.articleList}get prevArticle(){return this.articleList?.find(e=>e.prevNextFlag==="PREV")}get nextArticle(){return this.articleList?.find(e=>e.prevNextFlag==="NEXT")}get articleWriterName(){return this.articleService.getArticleWriterName(this.article)}goPrevNextArticle(e){j(e)||this.dialogRef.close({action:this.actions.RELOAD,data:{articleId:e}})}updateArticle(e){this.dialogRef.close({action:this.actions.UPDATE,data:e})}removeArticle(e){return W(this,null,function*(){(yield this.messageService.confirm2("\uAC8C\uC2DC\uAE00\uC744 \uC0AD\uC81C\uD558\uC2DC\uACA0\uC5B4\uC694?<br>\uC774 \uC791\uC5C5\uC740 \uBCF5\uAD6C\uD560 \uC218 \uC5C6\uC5B4\uC694."))&&this.articleService.removeArticle$(e).subscribe(()=>{this.messageService.toastSuccess("\uC815\uC0C1\uC801\uC73C\uB85C \uC0AD\uC81C\uB418\uC5C8\uC5B4\uC694."),this.dialogRef.close({action:this.actions.SAVE})})})}};i.\u0275fac=function(t){return new(t||i)(d(E),d(z),d(H),d(D))},i.\u0275cmp=x({type:i,selectors:[["modal-article-view"]],standalone:!0,features:[I,k],decls:21,vars:7,consts:[[1,"article-view"],[1,"article-view__top"],[1,"article-view__top__item"],[1,"pi","pi-clipboard"],[1,"pi","pi-user"],[3,"innerHTML"],[1,"pi","pi-clock"],[1,"article-view__content"],[1,"article-view__buttons"],[1,"article-view__buttons__prevnext"],[1,"article-view__buttons__crud"],[3,"size","severity"],[3,"click","icon","rounded","text","severity","disabled","title"],[3,"click","size","severity"]],template:function(t,o){t&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),C(3,"i",3),a(4,"p"),b(5),l()(),a(6,"div",2),C(7,"i",4)(8,"p",5),l(),a(9,"div",2),C(10,"i",6),a(11,"p"),b(12),l()()(),a(13,"div",7),C(14,"div",5),l(),a(15,"div",8)(16,"div",9),A(17,Fe,2,12),l(),a(18,"div",10),A(19,Le,2,2,"ui-button",11)(20,Be,2,2,"ui-button",11),l()()()),t&2&&(c(5),ne("\uAC8C\uC2DC\uD310: ",o.board.boardName,""),c(3),s("innerHTML",o.articleWriterName,J),c(4),M(o.article.createDt),c(2),s("innerHTML",o.article.articleContent,J),c(3),g(o.articleList.length>0?17:-1),c(2),g(o.article.articleWriterId==(o.user==null?null:o.user.userId)?19:-1),c(),g(o.isSystemAdmin||o.article.articleWriterId==(o.user==null?null:o.user.userId)?20:-1))},dependencies:[N],styles:[`.article-view__top{display:flex;justify-content:center;flex-wrap:wrap;gap:1rem;margin-bottom:2rem;padding:1rem;background-color:var(--surface-50)}@media (min-width: 35em){.article-view__top{gap:0}}.article-view__top__item{display:flex;align-items:center;gap:.5rem;width:100%}@media (min-width: 35em){.article-view__top__item{width:auto}}@media (min-width: 35em){.article-view__top__item+.article-view__top__item{margin-left:.75rem;padding-left:.75rem;border-left:1px solid var(--surface-200)}}.article-view__content img{max-width:100%}.article-view__buttons{display:flex;position:sticky;bottom:-1rem;justify-content:space-between;gap:1rem;margin-top:1rem;padding:.5rem 0;background-color:var(--surface-0)}.article-view__buttons__prevnext,.article-view__buttons__crud{display:flex;align-items:center;gap:.5rem}
`],encapsulation:2});let r=i;return r})();var je=()=>[10,15,20];function We(r,i){r&1&&C(0,"ui-skeleton")(1,"ui-skeleton")(2,"ui-skeleton")}function Ue(r,i){if(r&1){let n=_();a(0,"ui-button",3),u("click",function(){p(n);let t=m(2);return f(t.addArticle())}),l()}r&2&&s("size","small")("icon","pi-plus")("label","\uAC8C\uC2DC\uAE00 \uC791\uC131")("outlined",!0)}function $e(r,i){if(r&1){let n=_();a(0,"ui-button",3),u("click",function(){p(n);let t=m(2);return f(t.addArticle())}),l()}r&2&&s("size","small")("icon","pi-plus")("label","\uAC8C\uC2DC\uAE00 \uC791\uC131")("outlined",!0)}function Me(r,i){if(r&1){let n=_();a(0,"layout-page-description")(1,"ul")(2,"li"),b(3),l()()(),a(4,"ui-table",1,0),u("refresh",function(){p(n);let t=m();return f(t.onRefresh())})("rowSelect",function(t){p(n);let o=m();return f(o.onRowSelect(t))}),A(6,Ue,1,4,"ui-button",2)(7,$e,1,4,"ui-button",2),l()}if(r&2){let n=m();c(3),M(n.articleResponse==null?null:n.articleResponse.board.boardContent),c(),s("useAdd",!1)("useRemove",!1)("useRowIndex",!0)("useRowIndexDesc",!0)("emptymessage","\uAC8C\uC2DC\uAE00\uC774 \uC5C6\uC5B4\uC694.")("cols",n.cols)("rows",10)("rowsPerPageOptions",Y(14,je))("data",n.articleResponse==null?null:n.articleResponse.articleList)("dataKey","articleId")("selection",n.selection)("paginator",!0),c(2),g((n.articleResponse==null?null:n.articleResponse.board.boardTypeCode)==="NOTICE"&&n.isSystemAdmin?6:(n.articleResponse==null?null:n.articleResponse.board.boardTypeCode)!=="NOTICE"?7:-1)}}var Et=(()=>{let i=class i extends V{constructor(e,t,o,h,v,Ve,De){super(),this.router=e,this.route=t,this.articleStore=o,this.config=h,this.loadingService=v,this.dialogService=Ve,this.articleService=De,this.cols=[{field:"articleTitle",header:"\uC81C\uBAA9",valueGetter:F=>this.articleService.getArticleTitle(F,Number(this.user?.userId))},{field:"articleWriterName",header:"\uC791\uC131\uC790",valueGetter:F=>this.articleService.getArticleWriterName(F)},{field:"createDt",header:"\uC791\uC131\uC77C\uC2DC"}],this.destroy$=new te,e.events.pipe(ie(F=>F instanceof ce),re(this.destroy$)).subscribe(()=>{this.boardId=t.snapshot.params.boardId,this.articleResponseDataLoad||this.articleService.listArticle(this.boardId)})}get from(){return this.config.data?.from}get articleResponse(){return this.articleStore.select("articleResponse").value?.[this.boardId]?.data??null}get articleResponseDataLoad(){return this.articleStore.select("articleResponse").value?.[this.boardId]?.dataLoad??!1}ngOnInit(){if(this.from==="login"||this.from==="main"){this.articleResponseDataLoad||(this.boardId=this.config.data.boardId,this.articleService.listArticle(this.boardId));return}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}addArticle(){this.dialogService.open(R,{focusOnShow:!1,header:"\uAC8C\uC2DC\uAE00 \uC791\uC131\uD558\uAE30",width:"1000px",data:{boardId:this.boardId}}).onClose.subscribe(t=>{O(t)||t.action===this.actions.SAVE&&this.articleService.listArticle(this.boardId)})}updateArticle(e,t){this.dialogService.open(R,{focusOnShow:!1,header:"\uAC8C\uC2DC\uAE00 \uC218\uC815\uD558\uAE30",width:"1000px",data:{action:e,article:t}}).onClose.subscribe(h=>{O(h)||(h.action===this.actions.SAVE?this.articleService.listArticle(this.boardId):h.action===this.actions.RELOAD&&this.getArticle(h.data.articleId))})}getArticle(e){let t=setTimeout(()=>this.loadingService.setLoading(!0),500);this.articleService.getArticle$(e).subscribe(o=>{clearTimeout(t),this.loadingService.setLoading(!1),this.dialogService.open(Ne,{focusOnShow:!1,header:o.article.articleTitle,width:"1000px",data:o})?.onClose.subscribe(v=>{O(v)||(v.action===this.actions.SAVE?this.articleService.listArticle(this.boardId):v.action===this.actions.RELOAD?this.getArticle(v.data.articleId):v.action===this.actions.UPDATE&&this.updateArticle(v.action,v.data))})})}onRowSelect(e){this.getArticle(e.data.articleId)}onRefresh(){this.articleService.listArticle(this.boardId)}};i.\u0275fac=function(t){return new(t||i)(d(de),d(se),d(G),d(E),d(ue),d(fe),d(D))},i.\u0275cmp=x({type:i,selectors:[["view-article-list"]],standalone:!0,features:[I,k],decls:2,vars:1,consts:[["table",""],["first","",3,"refresh","rowSelect","useAdd","useRemove","useRowIndex","useRowIndexDesc","emptymessage","cols","rows","rowsPerPageOptions","data","dataKey","selection","paginator"],["buttons","",3,"size","icon","label","outlined"],["buttons","",3,"click","size","icon","label","outlined"]],template:function(t,o){t&1&&A(0,We,3,0)(1,Me,8,15),t&2&&g(o.articleResponseDataLoad?1:0)},dependencies:[he,ve,N,we]});let r=i;return r})();export{G as a,D as b,Ne as c,R as d,Et as e};
